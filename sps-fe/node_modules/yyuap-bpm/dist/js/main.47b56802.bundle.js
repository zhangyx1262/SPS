/*! build:uba by yueming@yonyou.com hash:47b56802773c3429f2e5, chunkhash:3f3c480a4faab8a0d778, name:main, filebase:main.47b56802.bundle.js, query:, file:js/main.47b56802.bundle.js */
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{112:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=h(n(23)),r=h(n(11)),o=h(n(14)),s=h(n(15)),i=h(n(24)),l=h(n(16)),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),(0,r.default)(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=h(n(1)),d=n(0),f=h(d),p=n(19),m=n(28);function h(e){return e&&e.__esModule?e:{default:e}}var y={processDefinitionId:u.default.string,processInstanceId:u.default.string},g=function(e){function t(){var e=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,l.default)(t)).call(this));return n.componentDidMount=function(e){return function(){var t=e.apply(this,arguments);return new a.default(function(e,n){return function r(o,s){try{var i=t[o](s),l=i.value}catch(e){return void n(e)}if(!i.done)return a.default.resolve(l).then(function(e){r("next",e)},function(e){r("throw",e)});e(l)}("next")})}}(i.default.mark(function t(){var a,r,o,s;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props,r=a.processDefinitionId,o=a.processInstanceId,e.next=3,(0,m.sendBpmTaskAJAX)("hisTasklist",{processDefinitionId:r,processInstanceId:o});case 3:s=e.sent,n.setState({data:s.data.data});case 5:case"end":return e.stop()}},t,e)})),n.state={data:[]},n.columns=[{title:"任务ID",dataIndex:"id",key:"id",width:"30%"},{title:"任务名称",dataIndex:"name",key:"name"},{title:"任务类型",dataIndex:"description",key:"description",render:function(e,t,n){return f.default.createElement("div",null,(0,m.descriptionToText)(e))}},{title:"执行者",dataIndex:"executionId",key:"executionId"},{title:"开始时间",dataIndex:"startTime",key:"startTime",render:function(e,t,n){return f.default.createElement("div",null,(0,m.timestampToDate)(e))}},{title:"结束时间",dataIndex:"endTime",key:"endTime",render:function(e,t,n){return null==e?f.default.createElement("div",null,"-"):f.default.createElement("div",null,(0,m.timestampToDate)(e))}},{title:"审批意见",dataIndex:"deleteReason",key:"deleteReason"},{title:"超时时间",dataIndex:"claimTime",key:"claimTime"}],n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}(t,d.Component),c(t,[{key:"render",value:function(){return f.default.createElement(p.Table,{bordered:!0,emptyText:function(){return f.default.createElement("span",null,"暂时没有流程历史数据")},columns:this.columns,data:this.state.data})}}]),t}();g.propTypes=y,g.defaultProps={processDefinitionId:"eiap508870:4:c3bc57e8-631a-11e8-8d04-0686c4000fcf",processInstanceId:"d5c3ab59-631a-11e8-8d04-0686c4000fcf"},t.default=g},131:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n(11)),r=d(n(14)),o=d(n(15)),s=d(n(16)),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,a.default)(e,r.key,r)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),c=d(l),u=d(n(1));function d(e){return e&&e.__esModule?e:{default:e}}var f={url:u.default.string,processDefinitionId:u.default.string,processInstanceId:u.default.string,width:u.default.string,height:u.default.string},p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,o.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(r.default?(0,r.default)(e,t):e.__proto__=t)}(t,l.Component),i(t,[{key:"render",value:function(){var e=this.props,t=e.processDefinitionId,n=e.processInstanceId,a=e.width,r=e.height,o=e.url;return c.default.createElement("div",null,c.default.createElement("iframe",{style:{width:a,height:r,minHeight:"300px"},src:o+"?processDefinitionId="+t+"&processInstanceId="+n,frameBorder:"0"}))}}]),t}();p.propTypes=f,p.defaultProps={url:"/eiap-plus/vendor/diagram-viewer/index.html",width:"99%",height:"300px",processDefinitionId:"eiap508870:4:c3bc57e8-631a-11e8-8d04-0686c4000fcf",processInstanceId:"d5c3ab59-631a-11e8-8d04-0686c4000fcf"},t.default=p},132:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=I(n(23)),r=I(n(11)),o=I(n(14)),s=I(n(15)),i=I(n(24)),l=I(n(52)),c=I(n(53)),u=I(n(16)),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),(0,r.default)(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),f=I(n(1)),p=n(0),m=I(p),h=n(19),y=I(n(133)),g=n(28),v=I(n(96));function I(e){return e&&e.__esModule?e:{default:e}}function w(e){return function(){var t=e.apply(this,arguments);return new a.default(function(e,n){return function r(o,s){try{var i=t[o](s),l=i.value}catch(e){return void n(e)}if(!i.done)return a.default.resolve(l).then(function(e){r("next",e)},function(e){r("throw",e)});e(l)}("next")})}}var b={id:f.default.string,appType:f.default.string,refCode:f.default.string,onBpmFlowClick:f.default.func,onStart:f.default.func,onEnd:f.default.func,onSuccess:f.default.func,onError:f.default.func},k=function(e){function t(e){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,u.default)(t)).call(this,e));return a.componentWillMount=function(){},a.componentDidMount=function(){"2"==a.props.appType&&a.setState({approvetype:"withdraw",comment:(0,g.approvetypeToText)("withdraw")})},a.handleChange=function(e){a.setState({approvetype:e,comment:(0,g.approvetypeToText)(e)})},a.handlerCommentChange=function(e){a.setState({comment:e.target.value})},a.handlerSubmitBtn=w(i.default.mark(function e(){var t,r,o,s,u,d,f;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props,r=t.onStart,o=t.onEnd,s=t.onSuccess,u=t.onError,""!=a.state.comment){e.next=4;break}return h.Message.create({content:"不能为空",color:"danger",position:"top"}),e.abrupt("return");case 4:return r&&r(),e.next=7,(0,g.sendBpmTaskAJAX)(a.state.approvetype,a.state);case 7:d=e.sent,e.t0=a.state.approvetype,e.next="agree"===e.t0?11:"unagree"===e.t0?11:"rejectToActivity"===e.t0?14:"signAdd"===e.t0?16:"delegate"===e.t0?18:20;break;case 11:return"success"==d.data.flag?(h.Message.create({content:d.data.msg,color:"info",position:"top"}),s&&s()):"faile"==d.data.flag&&(h.Message.create({content:d.data.msg,color:"danger",position:"top"}),u&&u({type:2,msg:d.data.msg})),d.data.assignAble&&(d.data.assignList.length>0&&a.setState({HuoDongID:d.data.assignList[0].activityId,HuoDongName:d.data.assignList[0].activityName}),o&&o(),f=(0,c.default)(JSON.parse(v.default),{title:"人员选择",backdrop:!1,hasPage:!0,refType:2,isRadio:!1,className:"",param:{refCode:a.props.refCode,tenantId:"",sysId:"",transmitParam:"EXAMPLE_CONTACTS,EXAMPLE_ORGANIZATION"},keyList:[],onSave:function(){var e=w(i.default.mark(function e(t,o){var c;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r&&r(),e.next=3,(0,g.sendBpmTaskAJAX)("commit",{activityId:a.state.HuoDongID,activityName:a.state.HuoDongName,comment:a.state.comment,taskId:a.state.taskId,approvetype:a.state.approvetype,processInstanceId:a.state.processInstanceId,participants:(0,l.default)(t,function(e){return{id:e.id}})}).catch(function(e){h.Message.create({content:""+e.toString(),color:"danger",position:"top"}),u&&u({type:2,msg:"服务器请求出错"})});case 3:"success"==(c=e.sent).data.flag?(h.Message.create({content:""+c.data.msg,color:"info",position:"top"}),a.setState({rejectlist:[],selectedRow:[]}),s&&s()):(h.Message.create({content:""+c.data.msg,color:"danger",position:"top"}),u&&u({type:2,msg:c.data.msg}));case 5:case"end":return e.stop()}},e,n)}));return function(t,n){return e.apply(this,arguments)}}(),showVal:"",showKey:"refname",verification:!1}),(0,y.default)(f)),e.abrupt("break",22);case 14:return"success"==d.data.flag?(o&&o(),a.setState({rejectlist:d.data.rejectlist,selectedRow:new Array(d.data.rejectlist.length),rejectToActivityShow:!0})):(h.Message.create({content:d.data.msg,color:"danger",position:"top"}),u&&u({type:2,msg:d.data.msg})),e.abrupt("break",22);case 16:return 1==d.data.status?(o&&o(),f=(0,c.default)(JSON.parse(v.default),{title:"加签人员",backdrop:!1,hasPage:!0,refType:2,isRadio:!1,className:"",param:{refCode:a.props.refCode,tenantId:"",sysId:"",transmitParam:"EXAMPLE_CONTACTS,EXAMPLE_ORGANIZATION"},keyList:[],onSave:function(){var e=w(i.default.mark(function e(t,o){var c;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r&&r(),e.next=3,(0,g.sendBpmTaskAJAX)("signaddtask",{approvetype:a.state.approvetype,comment:a.state.comment,processInstanceId:a.state.processInstanceId,taskId:a.state.taskId,userIds:(0,l.default)(t,function(e){return e.id})}).catch(function(e){h.Message.create({content:""+e.toString(),color:"danger",position:"top"}),u&&u({type:2,msg:"服务器请求出错"})});case 3:"success"==(c=e.sent).data.flag?(h.Message.create({content:""+c.data.msg,color:"info",position:"top"}),s&&s()):(h.Message.create({content:""+c.data.msg,color:"danger",position:"top"}),u&&u({type:2,msg:c.data.msg}));case 5:case"end":return e.stop()}},e,n)}));return function(t,n){return e.apply(this,arguments)}}(),showVal:"",showKey:"refname",verification:!1}),(0,y.default)(f)):(h.Message.create({content:d.data.msg,color:"danger",position:"top"}),u&&u({type:2,msg:d.data.msg})),e.abrupt("break",22);case 18:return 1==d.data.status?(o&&o(),f=(0,c.default)(JSON.parse(v.default),{title:"改派人员",backdrop:!1,hasPage:!0,refType:2,isRadio:!0,className:"",param:{refCode:a.props.refCode,tenantId:"",sysId:"",transmitParam:"EXAMPLE_CONTACTS,EXAMPLE_ORGANIZATION"},keyList:[],onSave:function(){var e=w(i.default.mark(function e(t,o){var l;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r&&r(),e.next=3,(0,g.sendBpmTaskAJAX)("delegatetask",{approvetype:a.state.approvetype,comment:a.state.comment,processInstanceId:a.state.processInstanceId,taskId:a.state.taskId,userId:Array.isArray(t)?t[0].id:""}).catch(function(e){h.Message.create({content:""+e.toString(),color:"danger",position:"top"}),u&&u({type:2,msg:"服务器请求出错"})});case 3:"success"==(l=e.sent).data.flag?(h.Message.create({content:""+l.data.msg,color:"info",position:"top"}),s&&s()):(h.Message.create({content:""+l.data.msg,color:"danger",position:"top"}),u&&u({type:2,msg:l.data.msg}));case 5:case"end":return e.stop()}},e,n)}));return function(t,n){return e.apply(this,arguments)}}(),showVal:"",showKey:"refname",verification:!1}),(0,y.default)(f)):(h.Message.create({content:d.data.msg,color:"danger",position:"top"}),u&&u({type:2,msg:d.data.msg})),e.abrupt("break",22);case 20:return"success"==d.data.flag?(h.Message.create({content:d.data.msg,color:"info",position:"top"}),s&&s()):(h.Message.create({content:d.data.msg,color:"danger",position:"top"}),u&&u({type:2,msg:d.data.msg})),e.abrupt("break",22);case 22:case"end":return e.stop()}},e,n)})),a.activityModalClose=function(){a.setState({rejectToActivityShow:!1,rejectlist:[],selectedRow:[]})},a.rejectToActivityOK=w(i.default.mark(function e(){var t,r,o,s,l;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props,r=t.onStart,t.onEnd,o=t.onSuccess,s=t.onError,r&&r(),e.next=4,(0,g.sendBpmTaskAJAX)("rejectToBillMaker",{activityId:a.state.activityId,approvetype:a.state.approvetype,comment:a.state.comment,processInstanceId:a.state.processInstanceId,taskId:a.state.taskId}).catch(function(e){h.Message.create({content:""+e.toString(),color:"danger",position:"top"}),s&&s({type:2,msg:"服务器请求错误"})});case 4:"success"==(l=e.sent).data.flag?(o&&o(),h.Message.create({content:""+l.data.msg,color:"info",position:"top"}),a.setState({rejectToActivityShow:!1,rejectlist:[],selectedRow:[]})):(h.Message.create({content:""+l.data.msg,color:"danger",position:"top"}),s&&s({type:2,msg:l.data.msg}));case 6:case"end":return e.stop()}},e,n)})),a.handlerFlow=function(){var e=a.props.onBpmFlowClick;e&&e()},a.state={approvetype:"agree",comment:"审批同意",processDefinitionId:e.processDefinitionId,processInstanceId:e.processInstanceId,taskId:e.id,activityId:"markerbill",rejectToActivityShow:!1,rejectlist:[],selectedRow:[],userIds:[],userId:null,HuoDongID:"",HuoDongName:""},a.rejectToActivityCol=[{title:"活动编码",dataIndex:"activityId",key:"activityId",width:"40%"},{title:"活动名称",dataIndex:"activityName",key:"activityName",width:"30%"}],a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}(t,p.Component),d(t,[{key:"render",value:function(){var e=this;return m.default.createElement("div",{className:"clearfix"},m.default.createElement("div",{style:{padding:"0px"}},"1"==this.props.appType&&m.default.createElement("div",null,m.default.createElement(h.Row,{style:{height:"46px",lineHeight:"46px",padding:"0 10px"}},m.default.createElement(h.Col,{md:8},m.default.createElement(h.Radio.RadioGroup,{name:"approvetype",selectedValue:this.state.approvetype,onChange:this.handleChange},m.default.createElement(h.Radio,{value:"agree"},"同意"),m.default.createElement(h.Radio,{value:"unagree"},"不同意"),m.default.createElement(h.Radio,{value:"rejectToActivity"},"驳回到环节"),m.default.createElement(h.Radio,{value:"rejectToBillMaker"},"驳回到制单人"),m.default.createElement(h.Radio,{value:"signAdd"},"加签"),m.default.createElement(h.Radio,{value:"delegate"},"改派"))),m.default.createElement(h.Col,{md:4,style:{textAlign:"right"}},"1"==this.props.appType&&m.default.createElement(h.Button,{onClick:this.handlerSubmitBtn,style:{marginRight:"10px"},colors:"primary"},"提交"),"1"==this.props.appType&&m.default.createElement(h.Button,{onClick:this.handlerFlow,colors:"primary"},"流程图"))),m.default.createElement(h.Row,{style:{padding:"0 10px"}},m.default.createElement(h.Col,{md:12},m.default.createElement("textarea",{style:{height:"75px",width:"100%",outline:"none",resize:"none",border:"1px solid #cecece",padding:"10px",marginBottom:"20px",borderRadius:"4px"},placeholder:"请输入处理意见",value:this.state.comment,onChange:this.handlerCommentChange})))),"2"==this.props.appType&&m.default.createElement("div",null,m.default.createElement(h.Row,{style:{height:"46px",lineHeight:"46px",padding:"0 10px"}},m.default.createElement(h.Col,{md:8},m.default.createElement(h.Radio.RadioGroup,{name:"approvetype",selectedValue:this.state.approvetype,onChange:this.handleChange},m.default.createElement(h.Radio,{value:"withdraw"},"弃审"))),m.default.createElement(h.Col,{md:4,style:{textAlign:"right"}},"2"==this.props.appType&&m.default.createElement(h.Button,{onClick:this.handlerSubmitBtn,style:{marginRight:"10px"},colors:"primary"},"提交"),"2"==this.props.appType&&m.default.createElement(h.Button,{onClick:this.handlerFlow,colors:"primary"},"流程图"))),m.default.createElement(h.Row,{style:{padding:"0 10px"}},m.default.createElement(h.Col,{md:12},m.default.createElement("textarea",{style:{height:"75px",width:"100%",outline:"none",resize:"none",border:"1px solid #cecece",padding:"10px",marginBottom:"20px",borderRadius:"4px"},placeholder:"请输入弃审意见",value:this.state.comment,onChange:this.handlerCommentChange}))))),m.default.createElement(h.Modal,{show:this.state.rejectToActivityShow,backdrop:!1,onHide:this.activityModalClose},m.default.createElement(h.Modal.Header,{closeButton:!0},m.default.createElement(h.Modal.Title,null," 活动列表 ")),m.default.createElement(h.Modal.Body,null,m.default.createElement(h.Table,{rowKey:function(e){return e.activityId},emptyText:function(){return m.default.createElement("div",null,"暂无数据")},rowClassName:function(t,n,a){return e.state.selectedRow[n]?"selected":""},onRowClick:function(t,n,a){var r=new Array(e.state.rejectlist.length);r[n]=!0,e.setState({activityId:t.activityId,selectedRow:r})},columns:this.rejectToActivityCol,data:this.state.rejectlist})),m.default.createElement(h.Modal.Footer,null,m.default.createElement(h.Button,{colors:"danger",style:{marginRight:"10px"},onClick:this.rejectToActivityOK}," 确定 "),m.default.createElement(h.Button,{onClick:this.activityModalClose}," 关闭 "))))}}]),t}();k.propTypes=b,k.defaultProps={appType:"1",refCode:"newuser"},t.default=k},170:function(e,t,n){"use strict";var a=s(n(0)),r=s(n(3)),o=s(n(179));function s(e){return e&&e.__esModule?e:{default:e}}r.default.render(a.default.createElement(o.default,null),document.querySelector("#app"))},179:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=f(n(11)),r=f(n(14)),o=f(n(15)),s=f(n(16)),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,a.default)(e,r.key,r)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),c=f(l),u=n(19),d=n(195);function f(e){return e&&e.__esModule?e:{default:e}}n(499);var p=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,s.default)(t)).call(this));return e.state={},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,o.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(r.default?(0,r.default)(e,t):e.__proto__=t)}(t,l.Component),i(t,[{key:"render",value:function(){return c.default.createElement("div",null,c.default.createElement(d.BpmTaskApprovalWrap,{onSuccess:function(){return console.log("success")},onError:function(e){return console.log(e)},appType:"1",id:"3be26f2debb442d9b5f8012ba40c3fa3"}),c.default.createElement(d.BpmLinkAssign,null),c.default.createElement(d.BpmFlowChart,{processDefinitionId:"eiap350694:3:e2e70948-9559-11e8-b376-02420cbf1b08",processInstanceId:"1352ad87-955e-11e8-b376-02420cbf1b08"}),c.default.createElement(d.BpmTable,{processDefinitionId:"eiap350694:3:e2e70948-9559-11e8-b376-02420cbf1b08",processInstanceId:"1352ad87-955e-11e8-b376-02420cbf1b08"}),c.default.createElement(d.BpmTestCheckTable,null),c.default.createElement(d.BpmButtonSubmit,{funccode:"ygdemo_yw_info",nodekey:"003",size:"lg",isOne:!1,url:"/ygdemo_yw_info/submit",urlAssignSubmit:"/ygdemo_yw_info/assignSubmit",checkedArray:[{id:"ea69b9bf-d8b5-47a7-a1fd-1114f36a9321",code:"180719001",name:"岳明-01",ly_code:"1",ly_sm:"岳明-01\0",zr_dw:"97da3229-3308-4492-a457-cb4d4e6264a4",zr_dw_name:"用友股份",zrr:null,xb_dw:null,xb_dw_name:null,xbr:null,begin_date:null,end_date:null,zy_cd:2,qt_ld:null,zbr:null,zbr_name:null,dbr:null,jfyq:null,db_info:null,jd_bl:null,rwpf:null,kpi_flag:0,kpi_level:1,state:0,create_name:null,create_name_name:null,create_time:null,update_name:null,update_name_name:null,update_time:null,unitid:null,unitid_name:null,id_ygdemo_yw_sub:null,metaDefinedName:"ygdemo_yw_info",namespace:"iuap_qy",status:0,changedPropertyNames:null,tenant_id:"tenant",dr:0,ts:1531970736e3},{id:"ea69b9bf-d8sssa7-a1fd-1114f36a9321",code:"180719001",name:"岳明-01",ly_code:"1",ly_sm:"岳明-01\0",zr_dw:"97da3229-3308-4492-a457-cb4d4e6264a4",zr_dw_name:"用友股份",zrr:null,xb_dw:null,xb_dw_name:null,xbr:null,begin_date:null,end_date:null,zy_cd:2,qt_ld:null,zbr:null,zbr_name:null,dbr:null,jfyq:null,db_info:null,jd_bl:null,rwpf:null,kpi_flag:0,kpi_level:1,state:0,create_name:null,create_name_name:null,create_time:null,update_name:null,update_name_name:null,update_time:null,unitid:null,unitid_name:null,id_ygdemo_yw_sub:null,metaDefinedName:"ygdemo_yw_info",namespace:"iuap_qy",status:0,changedPropertyNames:null,tenant_id:"tenant",dr:0,ts:1531970736e3}],onSuccess:function(){return console.log("success")},onError:function(e){return console.log(e)}},c.default.createElement(u.Button,{size:"sm",shape:"border",className:"admin"},c.default.createElement("i",{className:"uf uf-arrow-c-o-up"}),"提交")),c.default.createElement(d.BpmButtonRecall,{url:"/iuap_pap_quickstart/example_workorder/recall",checkedArray:[{id:"ccb34c6d3fc349789be73678d7cc8fac",createTime:"2018-07-04 12:36:26 088",createUser:"U001",lastModified:"2018-07-04 12:36:26 088",lastModifyUser:"U001",ts:"2018-07-04 12:36:26 088",dr:0,bpmState:1,taskKey:null,taskId:null,processInstanceId:null,processDefineCode:null,comment:null,orderCode:"201807042036265",orderName:null,supplier:null,supplierName:"11",type:"0",purchasing:"22",purchasingGroup:"22",voucherDate:15306336e5,approvalState:null,confirmState:null,closeState:null,type_name:"投诉工单",approvalState_name:null,confirmState_name:null,closeState_name:null,remark:null,bpmBillCode:null}]},c.default.createElement(u.Button,{size:"sm",shape:"border",className:"admin"},c.default.createElement("i",{className:"uf uf-arrow-c-o-down"}),"收回")))}}]),t}();t.default=p},195:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BpmLinkAssign=t.BpmButtonRecall=t.BpmButtonSubmit=t.BpmTaskApprovalWrap=t.BpmWrap=t.BpmTestCheckTable=t.BpmTaskApproval=t.BpmFlowChart=t.BpmTable=void 0;var a=f(n(112)),r=f(n(131)),o=f(n(132)),s=f(n(429)),i=f(n(430)),l=f(n(431)),c=f(n(432)),u=f(n(497)),d=f(n(498));function f(e){return e&&e.__esModule?e:{default:e}}t.BpmTable=a.default,t.BpmFlowChart=r.default,t.BpmTaskApproval=o.default,t.BpmTestCheckTable=s.default,t.BpmWrap=i.default,t.BpmTaskApprovalWrap=l.default,t.BpmButtonSubmit=c.default,t.BpmButtonRecall=u.default,t.BpmLinkAssign=d.default},28:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reconvert=t.approvetypeToText=t.onRecall=t.onCommit=t.queryBpmTemplateAllocate=t.billidToIds=t.sendBpmTaskAJAX=t.getBpmTaskURL=t.descriptionToText=t.timestampToDate=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(n(51)),r=n(19);t.timestampToDate=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd  hh:mm:ss",n=new Date(e),a=t;a=(a=a.replace(/yyyy|YYYY/,n.getFullYear())).replace(/yy|YY/,n.getYear()%100>9?(n.getYear()%100).toString():"0"+n.getYear()%100);var r=n.getMonth()+1;return a=(a=(a=(a=(a=(a=(a=(a=(a=(a=(a=a.replace(/MM/,r>9?r.toString():"0"+r)).replace(/M/g,r)).replace(/w|W/g,["日","一","二","三","四","五","六"][n.getDay()])).replace(/dd|DD/,n.getDate()>9?n.getDate().toString():"0"+n.getDate())).replace(/d|D/g,n.getDate())).replace(/hh|HH/,n.getHours()>9?n.getHours().toString():"0"+n.getHours())).replace(/h|H/g,n.getHours())).replace(/mm/,n.getMinutes()>9?n.getMinutes().toString():"0"+n.getMinutes())).replace(/m/g,n.getMinutes())).replace(/ss|SS/,n.getSeconds()>9?n.getSeconds().toString():"0"+n.getSeconds())).replace(/s|S/g,n.getSeconds())},t.descriptionToText=function(e){return"submit"==e?"提交":"agree"==e?"审批":"unagree"==e?"不同意":"reject"==e?"驳回":"signAdd"==e?"加签":"signAdding"==e?"加签中":"delegate"==e?"改派":"termination"==e?"终止":"withdraw"==e?"删除":"postCompleted"==e?"审批":void 0};var o=t.getBpmTaskURL=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/eiap-plus/";switch(e){case"agree":case"unagree":return t+"task/completetask/approveCard";case"rejectToActivity":return t+"task/rejecttask/bfreject";case"rejectToBillMaker":return t+"task/rejecttask/reject";case"signAdd":case"delegate":return t+"task/assignee/getlist";case"withdraw":return t+"task/withdrawtask/withdraw";case"hisTasklist":return t+"process/hisTasklist";case"commit":return t+"task/assigntask/commit";case"signaddtask":return t+"task/signaddtask/signadd";case"delegatetask":return t+"task/delegatetask/delegate";default:return"/"}};t.sendBpmTaskAJAX=function(e,t){switch(e){case"agree":case"unagree":case"rejectToActivity":return a.default.post(o(e),{approvetype:t.approvetype,comment:t.comment,processDefinitionId:t.processDefinitionId,processInstanceId:t.processInstanceId,taskId:t.taskId}).catch(function(e){r.Message.create({content:""+e.toString(),color:"danger",position:"top"})});case"rejectToBillMaker":return a.default.post(o(e),{activityId:t.activityId,approvetype:t.approvetype,comment:t.comment,processInstanceId:t.processInstanceId,taskId:t.taskId}).catch(function(e){r.Message.create({content:""+e.toString(),color:"danger",position:"top"})});case"signAdd":case"delegate":case"withdraw":return a.default.post(o(e),{approvetype:t.approvetype,comment:t.comment,processDefinitionId:t.processDefinitionId,processInstanceId:t.processInstanceId,taskId:t.taskId}).catch(function(e){r.Message.create({content:""+e.toString(),color:"danger",position:"top"})});case"hisTasklist":return a.default.post(o(e),{processDefinitionId:t.processDefinitionId,processInstanceId:t.processInstanceId}).catch(function(e){r.Message.create({content:""+e.toString(),color:"danger",position:"top"})});case"commit":return a.default.post(o(e),{activityId:t.activityId,activityName:t.activityName,comment:t.comment,taskId:t.taskId,approvetype:t.approvetype,processInstanceId:t.processInstanceId,participants:t.participants}).catch(function(e){r.Message.create({content:""+e.toString(),color:"danger",position:"top"})});case"signaddtask":return a.default.post(o(e),{approvetype:t.approvetype,comment:t.comment,processInstanceId:t.processInstanceId,taskId:t.taskId,userIds:t.userIds}).catch(function(e){r.Message.create({content:""+e.toString(),color:"danger",position:"top"})});case"delegatetask":return a.default.post(o(e),{approvetype:t.approvetype,comment:t.comment,processInstanceId:t.processInstanceId,taskId:t.taskId,userId:t.userId}).catch(function(e){r.Message.create({content:""+e.toString(),color:"danger",position:"top"})})}return a.default.post(o(e),t).catch(function(e){r.Message.create({content:""+e.toString(),color:"danger",position:"top"})})},t.billidToIds=function(e){return a.default.post("/eiap-plus/process/getbillbpm",{billId:e})},t.queryBpmTemplateAllocate=function(e){return a.default.get("/eiap-plus/appResAllocate/queryBpmTemplateAllocate?_="+Math.random(),{params:{funccode:e.funccode,nodekey:e.nodekey}})},t.onCommit=function(e){return(0,a.default)({url:""+e.url,method:"post",data:e.submitArray,params:{processDefineCode:e.processDefineCode}})},t.onRecall=function(e,t){return(0,a.default)({url:""+e,method:"post",data:t})},t.approvetypeToText=function(e){switch(e){case"agree":return"审批同意";case"unagree":return"审批不同意";case"rejectToActivity":return"驳回到环节";case"rejectToBillMaker":return"驳回到制单人";case"signAdd":return"加签";case"delegate":return"改派";case"withdraw":return"弃审"}},t.reconvert=function(e){return e=(e=(e=e.replace(/(\\u)(\w{1,4})/gi,function(e){return String.fromCharCode(parseInt(escape(e).replace(/(%5Cu)(\w{1,4})/g,"$2"),16))})).replace(/(&#x)(\w{1,4});/gi,function(e){return String.fromCharCode(parseInt(escape(e).replace(/(%26%23x)(\w{1,4})(%3B)/g,"$2"),16))})).replace(/(&#)(\d{1,6});/gi,function(e){return String.fromCharCode(parseInt(escape(e).replace(/(%26%23)(\d{1,6})(%3B)/g,"$2")))})}},429:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=m(n(23)),r=m(n(11)),o=m(n(14)),s=m(n(15)),i=m(n(24)),l=m(n(16)),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),(0,r.default)(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(0),d=m(u),f=n(19),p=m(n(51));function m(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(){var e=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,l.default)(t)).call(this));return n.componentDidMount=function(e){return function(){var t=e.apply(this,arguments);return new a.default(function(e,n){return function r(o,s){try{var i=t[o](s),l=i.value}catch(e){return void n(e)}if(!i.done)return a.default.resolve(l).then(function(e){r("next",e)},function(e){r("throw",e)});e(l)}("next")})}}(i.default.mark(function t(){var a,r;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="eiap-plus/process/undoTasklist",e.next=3,p.default.post(a,{draw:1,length:10,order:{},search:{search_EQ_code:"",undefined:"",processDefinitionName:"",billno:""},searchconfirm:{}});case 3:r=e.sent,Array.isArray(r.data.data)&&n.setState({data:r.data.data});case 5:case"end":return e.stop()}},t,e)})),n.state={data:[],factoryValue:{}},n.columns=[{title:"Name",dataIndex:"name",key:"name",width:"30%"},{title:"ID",dataIndex:"id",key:"id"},{title:"processDefinitionId",dataIndex:"processDefinitionId",key:"processDefinitionId"},{title:"processInstanceId",dataIndex:"processInstanceId",key:"processInstanceId"}],n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}(t,u.Component),c(t,[{key:"render",value:function(){var e=this;return d.default.createElement(f.Table,{bordered:!0,emptyText:function(){return d.default.createElement("span",null,"暂时没有数据")},columns:this.columns,data:this.state.data,title:function(){return d.default.createElement(f.Button,{colors:"primary",onClick:function(){document.location.hash="#/bdm/bpmapproval?id="+e.state.factoryValue.id+"&processDefinitionId="+e.state.factoryValue.processDefinitionId+"&processInstanceId="+e.state.factoryValue.processInstanceId}},"任务中心打开审批")},onRowClick:function(t,n,a){e.setState({factoryValue:t})}})}}]),t}();t.default=h},430:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=g(n(23)),r=g(n(11)),o=g(n(14)),s=g(n(15)),i=g(n(24)),l=g(n(16)),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),(0,r.default)(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(0),d=g(u),f=g(n(1)),p=n(19),m=g(n(131)),h=g(n(112)),y=n(28);function g(e){return e&&e.__esModule?e:{default:e}}var v={id:f.default.string,processDefinitionId:f.default.string,processInstanceId:f.default.string},I=function(e){function t(){var e=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,l.default)(t)).call(this));return n.componentWillMount=function(e){return function(){var t=e.apply(this,arguments);return new a.default(function(e,n){return function r(o,s){try{var i=t[o](s),l=i.value}catch(e){return void n(e)}if(!i.done)return a.default.resolve(l).then(function(e){r("next",e)},function(e){r("throw",e)});e(l)}("next")})}}(i.default.mark(function t(){var a,r,o,s;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.processDefinitionId){e.next=8;break}return e.next=3,(0,y.billidToIds)(n.props.id);case 3:a=e.sent,r=a.data,o=r.processDefinitionId,s=r.processInstanceId,n.setState({processDefinitionId:o,processInstanceId:s}),e.next=9;break;case 8:n.setState({processDefinitionId:n.props.processDefinitionId,processInstanceId:n.props.processInstanceId});case 9:case"end":return e.stop()}},t,e)})),n.state={processDefinitionId:"",processInstanceId:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}(t,u.Component),c(t,[{key:"render",value:function(){return d.default.createElement("div",null,d.default.createElement(p.Row,null,d.default.createElement(p.Col,{md:12},this.state.processDefinitionId&&d.default.createElement(m.default,{processDefinitionId:this.state.processDefinitionId,processInstanceId:this.state.processInstanceId}))),d.default.createElement(p.Row,null,d.default.createElement(p.Col,{md:12},this.state.processDefinitionId&&d.default.createElement(h.default,{processDefinitionId:this.state.processDefinitionId,processInstanceId:this.state.processInstanceId}))))}}]),t}();I.propTypes=v,I.defaultProps={id:""},t.default=I},431:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=y(n(23)),r=y(n(11)),o=y(n(14)),s=y(n(15)),i=y(n(24)),l=y(n(16)),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),(0,r.default)(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(0),d=y(u),f=y(n(1)),p=n(19),m=y(n(132)),h=n(28);function y(e){return e&&e.__esModule?e:{default:e}}var g={id:f.default.string,refCode:f.default.string,processDefinitionId:f.default.string,processInstanceId:f.default.string,onBpmFlowClick:f.default.func,appType:f.default.string,onStart:f.default.func,onEnd:f.default.func,onSuccess:f.default.func,onError:f.default.func},v=function(e){function t(){var e=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,l.default)(t)).call(this));return n.componentWillMount=function(e){return function(){var t=e.apply(this,arguments);return new a.default(function(e,n){return function r(o,s){try{var i=t[o](s),l=i.value}catch(e){return void n(e)}if(!i.done)return a.default.resolve(l).then(function(e){r("next",e)},function(e){r("throw",e)});e(l)}("next")})}}(i.default.mark(function t(){var a,r,o,s,l;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.processDefinitionId){e.next=7;break}return e.next=3,(0,h.billidToIds)(n.props.id);case 3:(a=e.sent).data.message&&"NoBpm"==a.data.message?n.setState({isShowFlowBtn:!1}):a.data.taskId?(r=a.data,o=r.processDefinitionId,s=r.processInstanceId,l=r.taskId,n.setState({id:l,processDefinitionId:o,processInstanceId:s})):n.setState({isShowFlowBtn:!0}),e.next=8;break;case 7:n.setState({processDefinitionId:n.props.processDefinitionId,processInstanceId:n.props.processInstanceId,id:n.props.id});case 8:case"end":return e.stop()}},t,e)})),n.state={isShowFlowBtn:!1,id:"",taskId:"",processDefinitionId:"",processInstanceId:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}(t,u.Component),c(t,[{key:"render",value:function(){return d.default.createElement("div",{className:"clearfix"},this.state.processDefinitionId&&d.default.createElement(p.Row,null,d.default.createElement(p.Col,{md:12},d.default.createElement(m.default,{id:this.state.id,refCode:this.props.refCode,onBpmFlowClick:this.props.onBpmFlowClick,processDefinitionId:this.state.processDefinitionId,processInstanceId:this.state.processInstanceId,appType:this.props.appType,onStart:this.props.onStart,onEnd:this.props.onEnd,onSuccess:this.props.onSuccess,onError:this.props.onError}))),this.state.isShowFlowBtn&&d.default.createElement(p.Row,null,d.default.createElement(p.Col,{mdOffset:11,md:1,style:{textAlign:"right"}},d.default.createElement(p.Button,{onClick:this.props.onBpmFlowClick,style:{marginBottom:"4px",marginRight:"15px"},colors:"primary"},"流程图"))))}}]),t}();v.propTypes=g,v.defaultProps={id:"",appType:"1",refCode:"newuser"},t.default=v},432:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=w(n(23)),r=w(n(11)),o=w(n(14)),s=w(n(15)),i=w(n(53)),l=w(n(24)),c=w(n(52)),u=w(n(16)),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),(0,r.default)(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),f=w(n(51)),p=w(n(1)),m=n(0),h=w(m),y=n(19),g=w(n(161)),v=n(28),I=w(n(96));function w(e){return e&&e.__esModule?e:{default:e}}function b(e){return function(){var t=e.apply(this,arguments);return new a.default(function(e,n){return function r(o,s){try{var i=t[o](s),l=i.value}catch(e){return void n(e)}if(!i.done)return a.default.resolve(l).then(function(e){r("next",e)},function(e){r("throw",e)});e(l)}("next")})}}n(495);var k={checkedArray:p.default.array,funccode:p.default.string,nodekey:p.default.string,url:p.default.string,urlAssignSubmit:p.default.string,className:p.default.string,filterRefUrl:p.default.string,refCode:p.default.string,size:p.default.string,scrollY:p.default.number,isOne:p.default.bool,onSuccess:p.default.func,onError:p.default.func,onStart:p.default.func,onEnd:p.default.func},_=function(e){function t(){var e=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,u.default)(t)).call(this));return n.handlerBtn=b(l.default.mark(function t(){var a,r,o,s,i,u,d,f,p,m,h,y,g,I,w,b;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.props,r=a.checkedArray,o=a.isOne,s=a.onStart,i=a.onEnd,u=a.onSuccess,d=a.onError,!(o&&r.length>=2)){e.next=4;break}return d&&d({type:2,msg:"请选择单条数据提交"}),e.abrupt("return");case 4:if(!(r.length>0)){e.next=29;break}if(!(r[0].bpmState>=1)){e.next=8;break}return d&&d({type:1,msg:"不能提交此单据，重复提交"}),e.abrupt("return");case 8:return s&&s(),e.next=11,(0,v.queryBpmTemplateAllocate)({funccode:n.props.funccode,nodekey:n.props.nodekey});case 11:if(f=e.sent,p=f.data,m=p.success,h=p.detailMsg,"success"!=m){e.next=26;break}return y={url:n.props.url,processDefineCode:h.data.res_code,submitArray:r},n.setState({processDefineCode:h.data.res_code}),e.next=20,(0,v.onCommit)(y);case 20:g=e.sent,"success"==(I=g.data.success)&&void 0===g.data.detailMsg.data.assignAble?u&&u():"fail_global"==I&&d&&d({type:2,msg:(0,v.reconvert)(g.data.message)||"流程启动失败"}),1==g.data.detailMsg.data.assignAble&&g.data.detailMsg.data.assignedActivities&&g.data.detailMsg.data.assignedActivities.length>0&&(i&&i(),n.setState({huanjieShow:!0,chaosongShow:!0,huanjieList:g.data.detailMsg.data.assignedActivities,obj:r,assignInfo:{assignInfoItems:(0,c.default)(g.data.detailMsg.data.assignedActivities,function(e){return{activityId:e.id,activityName:e.name,participants:[]}})}})),e.next=27;break;case 26:"fail_global"==m&&(w=result,b=w.data.message,d&&d({type:2,msg:(0,v.reconvert)(b)||"流程启动失败"}));case 27:e.next=30;break;case 29:d&&d({type:1,msg:"请选择提交的单据"});case 30:case"end":return e.stop()}},t,e)})),n.closeHuanjie=function(){n.setState({huanjieShow:!1,chaosongShow:!1,childRefKey:[],showVal:[]})},n.signAddOK=function(){var e=n.state.editRowIndex,t=n.state.assignInfo.assignInfoItems.slice();t[e].participants=(0,c.default)(n.state.userIds,function(e){return{id:e.id}}),n.setState({assignInfo:{assignInfoItems:t},userIds:[]})},n.huanjieHandlerOK=b(l.default.mark(function t(){var a,r,o,s,i,c,u,d,p,m,h,y,g;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props,r=a.urlAssignSubmit,o=a.onSuccess,s=a.onError,i=a.onStart,a.onEnd,c=n.state,u=c.processDefineCode,d=c.assignInfo,p=c.obj,m=c.copyusers,h=c.intersection,p=p[0],y=[],m.map(function(e){y=y.concat(e)}),m=y,i&&i(),e.next=9,f.default.post(r,{processDefineCode:u,assignInfo:d,obj:p,copyusers:m,intersection:h}).catch(function(e){s&&s({type:2,msg:"后台服务请求发生错误"})});case 9:"success"==(g=e.sent).data.success?(o&&o(),n.setState({huanjieShow:!1,chaosongShow:!1,childRefKey:[],showVal:[]})):"fail_global"==g.data.success&&(s&&s({type:2,msg:(0,v.reconvert)(g.data.message)||"流程启动失败"}),n.setState({huanjieShow:!1,chaosongShow:!1,childRefKey:[],showVal:[]}));case 11:case"end":return e.stop()}},t,e)})),n.changeCheck=function(){n.setState({intersection:!n.state.intersection})},n.state={childRefKey:[],userIds:[],processDefineCode:"",assignInfo:{assignInfoItems:[]},obj:[],huanjieShow:!1,huanjieList:[],chaosongShow:!1,editRowIndex:0,showVal:[],copyusers:[],copyuserShowVal:[],intersection:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}(t,m.Component),d(t,[{key:"render",value:function(){var e=this,t=[{title:"名称",dataIndex:"name",key:"name",width:"40%"},{title:"编码",dataIndex:"id",key:"id",width:"40%"},{title:"指派",dataIndex:"1",key:"1",width:"20%",render:function(t,n,a){return h.default.createElement(g.default,{disabled:!1,option:(0,i.default)(JSON.parse(I.default),{title:"指派人员选择",backdrop:!1,hasPage:!0,refType:2,isRadio:!1,filterRefUrl:e.props.filterRefUrl,className:"",param:{refCode:e.props.refCode,tenantId:"",sysId:"",transmitParam:"EXAMPLE_CONTACTS,EXAMPLE_ORGANIZATION"},keyList:e.state.childRefKey[a]||[],onSave:function(t,n){console.log(t);var r=t.map(function(e){return e.id}),o=e.state.showVal.slice();o[a]=n;var s=e.state.childRefKey.slice();s[a]=r;var i=e.state.assignInfo.assignInfoItems.slice();i[a].participants=(0,c.default)(s[a],function(e){return{id:e}}),e.setState({childRefKey:s,showVal:o,assignInfo:{assignInfoItems:i}})},showVal:e.state.showVal[a],showKey:"refname",verification:!1})})}}],n={title:"抄送部门选择",backdrop:!1,hasPage:!0,multiple:!0,refType:1,isRadio:!1,filterRefUrl:e.props.filterRefUrl,className:"",param:{refCode:e.props.organrefCode,tenantId:"",sysId:"",transmitParam:"EXAMPLE_CONTACTS,EXAMPLE_ORGANIZATION"},keyList:e.state.copyusers[0]?e.state.copyusers[0]:[],onSave:function(t,n){console.log(t);var a=t.map(function(e){return e.id}),r=e.state.copyuserShowVal.slice();r[0]=n;var o=e.state.copyusers.slice();o[0]=(0,c.default)(a,function(e){return{id:e,type:"DEPTS"}}),e.setState({copyusers:o,copyuserShowVal:r})},showVal:e.state.copyuserShowVal[0],showKey:"refname",verification:!1},a={title:"抄送岗位选择",backdrop:!1,hasPage:!0,multiple:!0,refType:1,isRadio:!1,filterRefUrl:e.props.filterRefUrl,className:"",param:{refCode:e.props.positonrefCode,tenantId:"",sysId:"",transmitParam:"EXAMPLE_CONTACTS,EXAMPLE_ORGANIZATION"},keyList:e.state.copyusers[1]?e.state.copyusers[1]:[],onSave:function(t,n){console.log(t);var a=t.map(function(e){return e.id}),r=e.state.copyuserShowVal.slice();r[1]=n;var o=e.state.copyusers.slice();o[1]=(0,c.default)(a,function(e){return{id:e,type:"POSTS"}}),e.setState({copyusers:o,copyuserShowVal:r})},showVal:e.state.copyuserShowVal[1],showKey:"refname",verification:!1},r={title:"抄送角色选择",backdrop:!1,hasPage:!0,refType:2,isRadio:!1,filterRefUrl:e.props.filterRefUrl,className:"",param:{refCode:e.props.refCode,tenantId:"",sysId:"",transmitParam:"EXAMPLE_CONTACTS,EXAMPLE_ORGANIZATION"},keyList:e.state.copyusers[2]?e.state.copyusers[2]:[],onSave:function(t,n){console.log(t);var a=t.map(function(e){return e.id}),r=e.state.copyuserShowVal.slice();r[2]=n;var o=e.state.copyusers.slice();o[2]=(0,c.default)(a,function(e){return{id:e,type:"USERGROUP"}}),e.setState({copyusers:o,copyuserShowVal:r})},showVal:e.state.copyuserShowVal[2],showKey:"refname",verification:!1},o={title:"抄送人员选择",backdrop:!1,hasPage:!0,refType:2,isRadio:!1,filterRefUrl:e.props.filterRefUrl,className:"",param:{refCode:e.props.refCode,tenantId:"",sysId:"",transmitParam:"EXAMPLE_CONTACTS,EXAMPLE_ORGANIZATION"},keyList:e.state.copyusers[3]?e.state.copyusers[3]:[],onSave:function(t,n){console.log(t);var a=t.map(function(e){return e.id}),r=e.state.copyuserShowVal.slice();r[3]=n;var o=e.state.copyusers.slice();o[3]=(0,c.default)(a,function(e){return{id:e,type:"USER"}}),e.setState({copyusers:o,copyuserShowVal:r})},showVal:e.state.copyuserShowVal[3],showKey:"refname",verification:!1};return h.default.createElement("span",null,h.default.createElement("span",{onClick:this.handlerBtn},this.props.children),h.default.createElement(y.Modal,{size:this.props.size,show:this.state.huanjieShow||this.state.chaosongShow,backdrop:!1,enforceFocus:!1,onHide:this.closeHuanjie},h.default.createElement(y.Modal.Header,{closeButton:!0},h.default.createElement(y.Modal.Title,null," ",this.state.huanjieShow?"环节指派":"抄送")),this.state.huanjieShow?h.default.createElement(y.Modal.Body,null,h.default.createElement(y.Table,{rowKey:function(e){return e.id},columns:t,data:this.state.huanjieList,scroll:{x:"100%",y:240}})):"",this.state.huanjieShow?h.default.createElement(y.Modal.Header,null,h.default.createElement(y.Modal.Title,null," 抄送 ")):"",this.state.chaosongShow?h.default.createElement(y.Modal.Body,null,h.default.createElement(y.Row,null,h.default.createElement(y.Label,{className:"refLabel"},"按部门:"),h.default.createElement("div",{className:"refcon"},h.default.createElement(g.default,{disabled:!1,option:(0,i.default)(JSON.parse(I.default),n)})),h.default.createElement(y.Label,{className:"refLabel"},"按岗位:"),h.default.createElement("div",{className:"refcon"},h.default.createElement(g.default,{disabled:!1,option:(0,i.default)(JSON.parse(I.default),a)}))),h.default.createElement(y.Row,{style:{marginTop:"15px",marginBottom:"15px"}},h.default.createElement(y.Label,{className:"refLabel"},"按角色:"),h.default.createElement("div",{className:"refcon"},h.default.createElement(g.default,{disabled:!1,option:(0,i.default)(JSON.parse(I.default),r)})),h.default.createElement(y.Label,{className:"refLabel"},"按用户:"),h.default.createElement("div",{className:"refcon"},h.default.createElement(g.default,{disabled:!1,option:(0,i.default)(JSON.parse(I.default),o)}))),h.default.createElement(y.Checkbox,{className:"intersection",checked:this.state.intersection,onChange:this.changeCheck},"是否交集")):"",h.default.createElement(y.Modal.Footer,null,h.default.createElement(y.Button,{style:{marginRight:"10px"},onClick:this.closeHuanjie}," 关闭 "),h.default.createElement(y.Button,{colors:"primary",onClick:this.huanjieHandlerOK}," 确定 "))))}}]),t}();_.propTypes=k,_.defaultProps={checkedArray:[],nodekey:"003",funccode:"react",url:"/example/ygdemo_yw_info/submit",urlAssignSubmit:"/example/ygdemo_yw_info/assignSubmit",className:"",filterRefUrl:"/iuap_pap_quickstart/common/filterRef",refCode:"newuser",size:"",scrollY:270,isOne:!1,organrefCode:"newdept",positonrefCode:"newposition",roleRef:"newrole",userRef:"newuser"},t.default=_},495:function(e,t,n){},497:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=m(n(23)),r=m(n(11)),o=m(n(14)),s=m(n(15)),i=m(n(24)),l=m(n(16)),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),(0,r.default)(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=m(n(1)),d=n(0),f=m(d),p=n(28);function m(e){return e&&e.__esModule?e:{default:e}}var h={checkedArray:u.default.array,url:u.default.string,data:u.default.array,className:u.default.string,onSuccess:u.default.func,onError:u.default.func,onStart:u.default.func,onEnd:u.default.func},y=function(e){function t(){var e=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,l.default)(t)).call(this));return n.handlerBtn=function(e){return function(){var t=e.apply(this,arguments);return new a.default(function(e,n){return function r(o,s){try{var i=t[o](s),l=i.value}catch(e){return void n(e)}if(!i.done)return a.default.resolve(l).then(function(e){r("next",e)},function(e){r("throw",e)});e(l)}("next")})}}(i.default.mark(function t(){var a,r,o,s,l,c,u,d,f;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.props,r=a.checkedArray,o=a.onStart,a.onEnd,s=a.onSuccess,l=a.onError,c=[],!(r.length>=2)){e.next=5;break}return l&&l({type:2,msg:"请选择单条数据收回"}),e.abrupt("return");case 5:if(!(r.length>0)){e.next=9;break}0!=r[0].bpmState&&null!=r[0].bpmState?c.push({id:r[0].id}):l&&l({type:1,msg:"流程没有启动无法撤回"}),e.next=11;break;case 9:return l&&l({type:1,msg:"请选择单据才能撤回"}),e.abrupt("return");case 11:if(!(c.length>0)){e.next=20;break}return o&&o(),e.next=15,(0,p.onRecall)(n.props.url,c);case 15:u=e.sent,d=u.data,d.success,(f=d.detailMsg).data.success&&"success"==f.data.success?s&&s():l&&l({type:2,msg:f.data.message});case 20:case"end":return e.stop()}},t,e)})),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}(t,d.Component),c(t,[{key:"render",value:function(){return f.default.createElement("span",{onClick:this.handlerBtn},this.props.children)}}]),t}();y.propTypes=h,y.defaultProps={checkedArray:[],url:"/example/ygdemo_yw_info/unsubmit",data:[],className:""},t.default=y},498:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=w(n(23)),r=w(n(11)),o=w(n(14)),s=w(n(15)),i=w(n(53)),l=w(n(24)),c=w(n(52)),u=w(n(16)),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),(0,r.default)(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),f=w(n(51)),p=w(n(1)),m=n(0),h=w(m),y=n(19),g=w(n(161)),v=n(28),I=w(n(96));function w(e){return e&&e.__esModule?e:{default:e}}function b(e){return function(){var t=e.apply(this,arguments);return new a.default(function(e,n){return function r(o,s){try{var i=t[o](s),l=i.value}catch(e){return void n(e)}if(!i.done)return a.default.resolve(l).then(function(e){r("next",e)},function(e){r("throw",e)});e(l)}("next")})}}var k={checkedArray:p.default.array,funccode:p.default.string,nodekey:p.default.string,url:p.default.string,urlAssignSubmit:p.default.string,className:p.default.string,filterRefUrl:p.default.string,refCode:p.default.string,scrollY:p.default.number,onSuccess:p.default.func,onError:p.default.func,onStart:p.default.func,onEnd:p.default.func},_=function(e){function t(){var e=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||(0,u.default)(t)).call(this));return n.handlerBtn=b(l.default.mark(function t(){var a,r,o,s,i,u,d,f,p,m,h,y,g,I,w;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.props,r=a.checkedArray,o=a.onStart,s=a.onEnd,i=a.onSuccess,u=a.onError,!(r.length>=2)){e.next=4;break}return u&&u({type:2,msg:"请选择单条数据提交"}),e.abrupt("return");case 4:if(!(r.length>0)){e.next=29;break}if(!(r[0].bpmState>=1)){e.next=8;break}return u&&u({type:1,msg:"不能提交此单据，重复提交"}),e.abrupt("return");case 8:return o&&o(),e.next=11,(0,v.queryBpmTemplateAllocate)({funccode:n.props.funccode,nodekey:n.props.nodekey});case 11:if(d=e.sent,f=d.data,p=f.success,m=f.detailMsg,"success"!=p){e.next=26;break}return h={url:n.props.url,processDefineCode:m.data.res_code,submitArray:r},n.setState({processDefineCode:m.data.res_code}),e.next=20,(0,v.onCommit)(h);case 20:y=e.sent,"success"==(g=y.data.success)&&void 0===y.data.detailMsg.data.assignAble?i&&i():"fail_global"==g&&u&&u({type:2,msg:(0,v.reconvert)(y.data.message)||"流程启动失败"}),1==y.data.detailMsg.data.assignAble&&y.data.detailMsg.data.assignedActivities&&y.data.detailMsg.data.assignedActivities.length>0&&(s&&s(),n.setState({huanjieShow:!0,huanjieList:y.data.detailMsg.data.assignedActivities,obj:r[0],assignInfo:{assignInfoItems:(0,c.default)(y.data.detailMsg.data.assignedActivities,function(e){return{activityId:e.id,activityName:e.name,participants:[]}})}})),e.next=27;break;case 26:"fail_global"==p&&(I=result,w=I.data.message,u&&u({type:2,msg:(0,v.reconvert)(w)||"流程启动失败"}));case 27:e.next=30;break;case 29:u&&u({type:1,msg:"请选择提交的单据"});case 30:case"end":return e.stop()}},t,e)})),n.closeHuanjie=function(){n.setState({huanjieShow:!1,childRefKey:[],showVal:[]})},n.signAddOK=function(){var e=n.state.editRowIndex,t=n.state.assignInfo.assignInfoItems.slice();t[e].participants=(0,c.default)(n.state.userIds,function(e){return{id:e.id}}),n.setState({assignInfo:{assignInfoItems:t},userIds:[]})},n.huanjieHandlerOK=b(l.default.mark(function t(){var a,r,o,s,i,c,u,d,p,m;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props,r=a.urlAssignSubmit,o=a.onSuccess,s=a.onError,i=a.onStart,a.onEnd,c=n.state,u=c.processDefineCode,d=c.assignInfo,p=c.obj,i&&i(),e.next=5,f.default.post(r,{processDefineCode:u,assignInfo:d,obj:p}).catch(function(e){s&&s({type:2,msg:"后台服务请求发生错误"})});case 5:"success"==(m=e.sent).data.success?(o&&o(),n.setState({huanjieShow:!1,childRefKey:[],showVal:[]})):"fail_global"==m.data.success&&(s&&s({type:2,msg:(0,v.reconvert)(m.data.message)||"流程启动失败"}),n.setState({huanjieShow:!1,childRefKey:[],showVal:[]}));case 7:case"end":return e.stop()}},t,e)})),n.state={childRefKey:[],userIds:[],processDefineCode:"",assignInfo:{assignInfoItems:[]},obj:{},huanjieShow:!1,huanjieList:[{id:"approveUserTask3283",name:"1",type:"userTask"},{id:"approveUserTask3183",name:"1",type:"userTask"},{id:"approveUserTask3a83",name:"1",type:"userTask"},{id:"approveUserTask3s83",name:"1",type:"userTask"},{id:"approveUserTask32d3",name:"1",type:"userTask"},{id:"approveUserTask3zza83",name:"1",type:"userTask"},{id:"approveUserTasqzza83",name:"1",type:"userTask"},{id:"approveUserTask34za83",name:"1",type:"userTask"},{id:"approveUserTas43zza83",name:"1",type:"userTask"}],editRowIndex:0,showVal:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}(t,m.Component),d(t,[{key:"render",value:function(){var e=this,t=[{title:"名称",dataIndex:"name",key:"name",width:"40%"},{title:"编码",dataIndex:"id",key:"id",width:"40%"},{title:"指派",dataIndex:"1",key:"1",width:"20%",render:function(t,n,a){return h.default.createElement(g.default,{disabled:!1,option:(0,i.default)(JSON.parse(I.default),{title:"人员选择",backdrop:!1,hasPage:!0,refType:2,isRadio:!1,filterRefUrl:e.props.filterRefUrl,className:"",param:{refCode:e.props.refCode,tenantId:"",sysId:"",transmitParam:"EXAMPLE_CONTACTS,EXAMPLE_ORGANIZATION"},keyList:e.state.childRefKey[a]||[],onSave:function(t,n){console.log(t);var r=t.map(function(e){return e.id}),o=e.state.showVal.slice();o[a]=n;var s=e.state.childRefKey.slice();s[a]=r;var i=e.state.assignInfo.assignInfoItems.slice();i[a].participants=(0,c.default)(s[a],function(e){return{id:e}}),e.setState({childRefKey:s,showVal:o,assignInfo:{assignInfoItems:i}})},showVal:e.state.showVal[a],showKey:"refname",verification:!1})})}}];return h.default.createElement(y.Table,{loading:!1,scroll:{y:this.props.scrollY},emptyText:function(){return h.default.createElement("span",null,"暂无环节")},rowKey:function(e){return e.id},columns:t,data:this.state.huanjieList})}}]),t}();_.propTypes=k,_.defaultProps={checkedArray:[],nodekey:"003",funccode:"react",url:"/example/ygdemo_yw_info/submit",urlAssignSubmit:"/example/ygdemo_yw_info/assignSubmit",className:"",filterRefUrl:"/iuap_pap_quickstart/common/filterRef",refCode:"newuser",scrollY:270},t.default=_},96:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(427));var r={title:"",refType:2,className:"",param:{refCode:"bd_common_user",tenantId:"",sysId:"",transmitParam:"EXAMPLE_CONTACTS,EXAMPLE_ORGANIZATION"},refModelUrl:{TreeUrl:"/newref/rest/iref_ctr/blobRefTree",TableBodyUrl:"/newref/rest/iref_ctr/blobRefTreeGrid",TableBarUrl:"/newref/rest/iref_ctr/refInfo"},filterRefUrl:"/iuap_pap_quickstart/common/filterRef",onCancel:function(e){console.log(e)},filterKey:[{title:"人员名称人员名称人员名称",key:"peoname"},{title:"人员名称",key:"peoname"},{title:"人员名称",key:"peoname"},{title:"人员名称",key:"peoname"},{title:"人员名称",key:"peoname"},{title:"人员名称",key:"peoname"},{title:"人员名称",key:"peoname"},{title:"人员名称",key:"peoname"},{title:"人员名称",key:"peoname"},{title:"人员名称",key:"peoname"},{title:"人员名称",key:"peoname"}],textOption:{modalTitle:"选择品类",leftTitle:"品类结构",rightTitle:"品类列表",leftTransferText:"待选品类",rightTransferText:"已选品类",leftInfo:[{text:"流水号",key:"peoname"},{text:"品类编码",key:"institid"},{text:"品类描述",key:"refname"}],rightInfo:[{text:"流水号",key:"id"},{text:"品类编码",key:"id"},{text:"品类描述",key:"peocode"}]}};t.default=(0,a.default)(r)}},[[170,1,2]]]);
//# sourceMappingURL=main.47b56802.bundle.js.map